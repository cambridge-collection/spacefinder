<%= nested_form_for(@space, :html => { :multipart => true }) do |f| %>
<% if @space.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@space.errors.count, "error") %> prohibited this space from being saved:</h2>

    <ul>
    <% @space.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
    </ul>
  </div>
<% end %>
  <div class="header"><span class="title">Basic info</span></div>
  <div class="section">
    
    <%= f.fields_for :space_photos do |photo_form| %>
      <div class="field">
        <% if photo_form.object.new_record? %>
          <%= photo_form.label :photo %>
          <%= photo_form.file_field :photo %>
        <% else %> 
          <%= image_tag(photo_form.object.photo.url(:resized)) %>
          <%= photo_form.link_to_remove "Remove this photo" %>
        <% end %>
      </div>
    <% end %>  
    <p><%= f.link_to_add "Add photo", :space_photos %></p>
      <div class="field">
        <%= f.label :name, "Name of space (e.g. first floor west, the red bean bags or relaxed reading space)" %>
        <%= f.text_field :name %>
      </div>
      <div class="field">
        <%= f.label :description, "Short description" %>
        <%= f.text_area :description %>
      </div>
      <div class="field">
        <%= f.label :space_type_id, "Type" %>
        <%= f.collection_select(:space_type_id, SpaceType.all, :id, :title, {selected: SpaceType.find_by(title:"Library space").id}) %>
      </div>
      <div class="field">
        <%= f.label :access_id, "Who can use this space?" %>
        <%= f.collection_select(:access_id, Access.all, :id, :title, {selected: Access.find_by(title:"Anyone (public)").id }) %>
      </div>
      
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :restricted,
        label: "Access restricted"
      } %>
      
      <div class="field">
        <%= f.label :restriction, "Description of access restriction  (e.g. Electronic badge entry after 18:00)" %>
        <%= f.text_field :restriction %>
      </div>
      
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :disabled_access,
        label: "Accessible by the disabled"
      } %>
      
      <div class="field">
        <%= f.label :expensive, "If this is a café, restaurant or bar how expensive is it?
        (1 = cheap, 5 = expensive)" %>
        <%= f.number_field :expensive, min: 1, max: 5 %>
      </div>
  </div>
  <div class="header"><span class="title">Location</span></div>
  <div class="section">
      <div class="field">
        <%= f.label :address, "Street address" %>
        <%= f.text_area :address %>
      </div>
      <div class="field">
        <%= f.label :library_id, "In library" %>
        <%= f.collection_select(:library_id, Library.order('name ASC'), :id, :name) %>
        or add new library:
        <%= f.text_field :new_library_name %>
      </div>
      <div class="field">
        <%= f.label :floor, "Floor" %>
        <%= f.text_field :floor %>
      </div>
      <div class="location">
        <div class="field">
          <%= f.label :lat, "Latitude (decimal coordinates e.g. 52.197949)" %>
          <%= f.text_field :lat %>
        </div>
        <div class="field">
          <%= f.label :lng, "Longitude (decimal coordinates e.g. 0.122951)" %>
          <%= f.text_field :lng %>
        </div>
        <a href="#" class="get-location btn">Use my location</a>
      </div>

  </div>
  <div class="header"><span class="title">Opening hours</span></div>

  <div class="section">
      <h2>Term-time opening hours</h2>
      
      
      <div class="term-times">
        <%= f.fields_for :term_time_hours do |term_time_hours_form| %>
          <% OpeningHoursWeek.days.each do |day| %>
            <%= render partial: "opening_hours_day", locals: {
              f: term_time_hours_form,
              day: day,
              label: day[0,3].titlecase
            } %>
          <% end %>
        <% end %>
         
      </div>
      <h2 class="times-label">Out-of-term opening hours</h2>
      <div class="holiday-times">
        <%= f.fields_for :out_of_term_hours do |out_of_term_hours_form| %>
          <% OpeningHoursWeek.days.each do |day| %>
            <%= render partial: "opening_hours_day", locals: {
              f: out_of_term_hours_form,
              day: day,
              label: day[0,3].titlecase
            } %>
          <% end %>
        <% end %>
      </div>
      <a href="#" id="show-holiday-times" class="btn">Show holiday times</a>
  </div>
  <div class="header"><span class="title">Contact details</span></div>
  <div class="section">
      <div class="field">
        <%= f.label :url, "Website URL" %>
        <%= f.text_field :url %>
      </div>
      <div class="field">
        <%= f.label :phone_number, "Phone number" %>
        <%= f.text_field :phone_number %>
      </div>
      <div class="field">
        <%= f.label :email_address, "Email address" %>
        <%= f.text_field :email_address %>
      </div>
      <div class="field">
        <%= f.label :twitter_screen_name, "Twitter screen name (e.g. 'cambridge_uni')" %>
        <%= f.text_field :twitter_screen_name, :value => f.object.twitter_screen_name.nil? ? "" : "@#{f.object.twitter_screen_name.tr('@','')}" %>
      </div>
      <div class="field">
        <%= f.label :facebook_url, "Facebook page name (e.g. 'thesnugbar' or 'pages/Central-Library-Cambridge/106156113195')" %>
        <%= f.text_field :facebook_url %>
      </div>
  </div>
  <div class="header"><span class="title">atmosphere</span></div>
  <div class="section">
    <p>Would you describe the atmosphere of this space as…</p>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :atmosphere_disciplined,
        label: "Disciplined?"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :atmosphere_relaxed,
        label: "Relaxed or informal?"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :atmosphere_historic,
        label: "Historic?"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :atmosphere_modern,
        label: "Modern?"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :atmosphere_inspiring,
        label: "Inspiring or thought provoking?"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :atmosphere_cosy,
        label: "Cosy?"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :atmosphere_social,
        label: "Social?"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :atmosphere_friendly,
        label: "Friendly or welcoming?"
      } %>
  </div>

  <div class="header"><span class="title">Noise levels</span></div>
  <div class="section">
      <div class="field">
        <%= f.label :noise_id, "Which best describes the typical noise level in this space?" %>
        <%= f.collection_select(:noise_id, Noise.all, :id, :title) %>
      </div>
  </div>
  
  <div class="header"><span class="title">Facilities</span></div>
  <div class="section">
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_food_drink,
        label: "Food & drink allowed"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_daylight,
        label: "Natural daylight"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_views,
        label: "Attractive views out of the window"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_large_desks,
        label: "Large desks"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_free_wifi,
        label: "Free Wifi"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_no_wifi,
        label: "No WiFi"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_computers,
        label: "Computers"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_laptops_allowed,
        label: "Laptops allowed"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_sockets,
        label: "Plug sockets"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_signal,
        label: "Phone signal"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_printers_copiers,
        label: "Printers and copiers"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_whiteboards,
        label: "Whiteboards"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_projector,
        label: "Projector"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_outdoor_seating,
        label: "Outdoor seating"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_bookable,
        label: "Bookable"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_toilets,
        label: "Toilets nearby"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_refreshments,
        label: "Close to refreshments"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :facility_break,
        label: "Close to a place to take a break"
      } %>
  </div>

  <div class="header"><span class="title">Work environment</span></div>
  <div class="section">
    <p>Is this a good space to work…</p>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :work_private,
        label: "Alone, in private"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :work_close,
        label: "Where others are working"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :work_friends,
        label: "With friends"
      } %>
      <%= render partial: "checkbox", locals: {
        f: f,
        field: :work_group,
        label: "On a group project"
      } %>
  </div>
  <div class="header"><span class="title">Tags</span></div>
  <div class="section">
      <div class="field">
        <%= f.label :tags, "Some tags that might be used to describe this space. Try to choose tags that are distinct from the questions above. Please list them separated by a comma. (e.g. dark, bottled water only, busy)" %>
        <%= f.text_field :tag_list, value: @space.tag_list.to_s %>
      </div>
  </div>







  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>